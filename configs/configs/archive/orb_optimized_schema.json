{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "ORB Optimized Trading System Configuration",
  "description": "Comprehensive configuration schema for the optimized ORB trading system with dynamic scaling and risk management",
  "type": "object",
  "required": [
    "account_config",
    "position_sizing",
    "risk_management", 
    "performance_gates",
    "trading_params",
    "execution_config"
  ],
  "properties": {
    "account_config": {
      "type": "object",
      "required": ["account_value", "tier", "environment"],
      "properties": {
        "account_value": {
          "type": "number",
          "minimum": 10000,
          "description": "Current account value in USD"
        },
        "tier": {
          "type": "string",
          "enum": ["foundation", "development", "proficient", "expert"],
          "description": "Account tier based on value and performance"
        },
        "environment": {
          "type": "string",
          "enum": ["paper", "live"],
          "description": "Trading environment"
        },
        "base_currency": {
          "type": "string",
          "default": "USD",
          "description": "Base currency for calculations"
        }
      }
    },
    "position_sizing": {
      "type": "object",
      "required": ["base_size", "scaling_method", "volatility_adjustment"],
      "properties": {
        "base_size": {
          "type": "number",
          "minimum": 500,
          "maximum": 10000,
          "description": "Base position size in USD before adjustments"
        },
        "scaling_method": {
          "type": "string",
          "enum": ["dynamic", "fixed", "kelly"],
          "default": "dynamic",
          "description": "Position sizing calculation method"
        },
        "volatility_adjustment": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean", "default": true},
            "vix_source": {"type": "string", "default": "CBOE"},
            "adjustment_factor": {"type": "number", "default": 25},
            "min_multiplier": {"type": "number", "default": 0.25},
            "max_multiplier": {"type": "number", "default": 2.0}
          }
        },
        "account_scaling": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean", "default": true},
            "reference_account": {"type": "number", "default": 100000},
            "max_scale_factor": {"type": "number", "default": 1.5}
          }
        },
        "max_limits": {
          "type": "object",
          "properties": {
            "single_position_pct": {"type": "number", "default": 8.0},
            "daily_exposure_pct": {"type": "number", "default": 25.0},
            "symbol_concentration_pct": {"type": "number", "default": 12.0}
          }
        }
      }
    },
    "risk_management": {
      "type": "object",
      "required": ["daily_limits", "circuit_breakers", "drawdown_controls"],
      "properties": {
        "daily_limits": {
          "type": "object",
          "properties": {
            "max_loss_usd": {"type": "number"},
            "max_loss_pct": {"type": "number"},
            "max_trades": {"type": "number"},
            "loss_limit_method": {
              "type": "string",
              "enum": ["fixed", "tier_based", "percentage"],
              "default": "tier_based"
            }
          }
        },
        "circuit_breakers": {
          "type": "object",
          "properties": {
            "consecutive_loss_limits": {
              "type": "object",
              "properties": {
                "level_1": {"type": "number", "default": 3},
                "level_2": {"type": "number", "default": 5},
                "level_3": {"type": "number", "default": 7}
              }
            },
            "actions": {
              "type": "object",
              "properties": {
                "level_1_reduction": {"type": "number", "default": 0.25},
                "level_2_reduction": {"type": "number", "default": 0.50},
                "level_3_shutdown": {"type": "boolean", "default": true}
              }
            }
          }
        },
        "drawdown_controls": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean", "default": true},
            "measurement_period": {"type": "string", "default": "daily"},
            "zones": {
              "type": "object",
              "properties": {
                "normal": {"drawdown_threshold": -0.01, "position_multiplier": 1.0},
                "caution": {"drawdown_threshold": -0.02, "position_multiplier": 0.8},
                "warning": {"drawdown_threshold": -0.035, "position_multiplier": 0.6},
                "danger": {"drawdown_threshold": -0.05, "position_multiplier": 0.4},
                "emergency": {"drawdown_threshold": -0.08, "position_multiplier": 0.2},
                "lockdown": {"drawdown_threshold": -0.08, "position_multiplier": 0.0}
              }
            }
          }
        },
        "market_filters": {
          "type": "object",
          "properties": {
            "vix_filter": {
              "enabled": {"type": "boolean", "default": true},
              "max_vix": {"type": "number", "default": 50}
            },
            "volume_filter": {
              "enabled": {"type": "boolean", "default": true},
              "min_relative_volume": {"type": "number", "default": 1.5}
            },
            "news_events": {
              "enabled": {"type": "boolean", "default": true},
              "earnings_buffer_hours": {"type": "number", "default": 2},
              "fomc_reduction": {"type": "number", "default": 0.5}
            }
          }
        }
      }
    },
    "performance_gates": {
      "type": "object",
      "required": ["evaluation_periods", "promotion_criteria", "demotion_criteria"],
      "properties": {
        "evaluation_periods": {
          "type": "object",
          "properties": {
            "daily_review": {"type": "boolean", "default": true},
            "weekly_assessment": {"type": "boolean", "default": true},
            "monthly_evaluation": {"type": "boolean", "default": true},
            "minimum_trades_for_evaluation": {"type": "number", "default": 30}
          }
        },
        "promotion_criteria": {
          "type": "object",
          "properties": {
            "win_rate_threshold": {"type": "number", "default": 0.58},
            "sharpe_ratio_threshold": {"type": "number", "default": 2.0},
            "max_drawdown_threshold": {"type": "number", "default": 0.03},
            "profit_factor_threshold": {"type": "number", "default": 1.8},
            "consistency_threshold": {"type": "number", "default": 0.70}
          }
        },
        "demotion_criteria": {
          "type": "object",
          "properties": {
            "win_rate_threshold": {"type": "number", "default": 0.45},
            "sharpe_ratio_threshold": {"type": "number", "default": 1.0},
            "max_drawdown_threshold": {"type": "number", "default": 0.05},
            "profit_factor_threshold": {"type": "number", "default": 1.2},
            "consistency_threshold": {"type": "number", "default": 0.40}
          }
        },
        "scaling_triggers": {
          "type": "object",
          "properties": {
            "scale_up_days": {"type": "number", "default": 10},
            "scale_down_weeks": {"type": "number", "default": 3},
            "exceptional_performance_multiplier": {"type": "number", "default": 1.25},
            "poor_performance_multiplier": {"type": "number", "default": 0.5}
          }
        }
      }
    },
    "trading_params": {
      "type": "object",
      "required": ["orb_settings", "entry_rules", "exit_rules"],
      "properties": {
        "orb_settings": {
          "type": "object",
          "properties": {
            "orb_minutes": {"type": "number", "default": 15, "minimum": 5, "maximum": 30},
            "breakout_threshold": {"type": "number", "default": 0.001},
            "volume_confirmation": {"type": "boolean", "default": true},
            "trend_alignment": {"type": "boolean", "default": true}
          }
        },
        "entry_rules": {
          "type": "object",
          "properties": {
            "market_open_delay": {"type": "number", "default": 5},
            "entry_cutoff_time": {"type": "string", "default": "13:00"},
            "max_gap_percent": {"type": "number", "default": 10.0},
            "min_gap_percent": {"type": "number", "default": 2.0},
            "rsi_range": {"min": 30, "max": 70}
          }
        },
        "exit_rules": {
          "type": "object",
          "properties": {
            "stop_loss_pct": {"type": "number", "default": -0.01},
            "take_profit_pct": {"type": "number", "default": 0.05},
            "trailing_stop": {"type": "boolean", "default": false},
            "time_based_exit": {"type": "string", "default": "15:45"},
            "partial_exits": {"type": "boolean", "default": false}
          }
        },
        "symbols": {
          "type": "object",
          "properties": {
            "primary_list": {
              "type": "array",
              "items": {"type": "string"},
              "default": ["NVDA", "TSLA", "AMD", "AAPL", "MSFT"]
            },
            "excluded_symbols": {
              "type": "array", 
              "items": {"type": "string"},
              "default": []
            },
            "market_cap_filter": {
              "min": {"type": "number", "default": 1000000000},
              "max": {"type": "number", "default": 3000000000000}
            },
            "price_filter": {
              "min": {"type": "number", "default": 10.0},
              "max": {"type": "number", "default": 1000.0}
            }
          }
        }
      }
    },
    "execution_config": {
      "type": "object",
      "properties": {
        "broker_settings": {
          "type": "object",
          "properties": {
            "primary_broker": {"type": "string", "default": "IBKR"},
            "backup_broker": {"type": "string", "default": null},
            "connection_params": {
              "host": {"type": "string", "default": "127.0.0.1"},
              "port": {"type": "number", "default": 7497},
              "client_id": {"type": "number", "default": 1}
            }
          }
        },
        "order_management": {
          "type": "object",
          "properties": {
            "order_type": {"type": "string", "enum": ["market", "limit", "stop"], "default": "market"},
            "use_oco_orders": {"type": "boolean", "default": true},
            "slippage_buffer": {"type": "number", "default": 0.01},
            "order_timeout": {"type": "number", "default": 30},
            "max_order_retries": {"type": "number", "default": 3}
          }
        },
        "notifications": {
          "type": "object",
          "properties": {
            "enabled": {"type": "boolean", "default": true},
            "channels": {
              "email": {"enabled": false, "address": null},
              "telegram": {"enabled": false, "chat_id": null, "bot_token": null},
              "webhook": {"enabled": false, "url": null}
            },
            "alert_types": {
              "trade_entries": {"type": "boolean", "default": true},
              "trade_exits": {"type": "boolean", "default": true},
              "risk_breaches": {"type": "boolean", "default": true},
              "performance_milestones": {"type": "boolean", "default": true}
            }
          }
        },
        "logging": {
          "type": "object",
          "properties": {
            "level": {"type": "string", "enum": ["DEBUG", "INFO", "WARNING", "ERROR"], "default": "INFO"},
            "file_rotation": {"type": "boolean", "default": true},
            "max_file_size_mb": {"type": "number", "default": 50},
            "backup_count": {"type": "number", "default": 7},
            "log_trades_to_db": {"type": "boolean", "default": true}
          }
        }
      }
    },
    "metadata": {
      "type": "object",
      "properties": {
        "config_version": {"type": "string", "default": "1.0.0"},
        "created_date": {"type": "string", "format": "date-time"},
        "last_modified": {"type": "string", "format": "date-time"},
        "created_by": {"type": "string"},
        "strategy_name": {"type": "string", "default": "ORB_Optimized"},
        "description": {"type": "string"},
        "backtest_results": {
          "type": "object",
          "properties": {
            "sharpe_ratio": {"type": "number"},
            "annual_return": {"type": "number"},
            "max_drawdown": {"type": "number"},
            "win_rate": {"type": "number"},
            "profit_factor": {"type": "number"}
          }
        }
      }
    }
  }
}